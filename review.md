# Задача формы лежащей капли

## Математические преобразования

### Шаг 1: Физическая основа — уравнение Лапласа
Капля находится в равновесии, а разность давления $p_1-p_2$ на её поверхности определяется уравнением Лапласа:
$$
p_1-p_2=\sigma (\frac{1}{R_1}+\frac{1}{R_2}),
$$

где:

- $\sigma$ — коэффициент поверхностного натяжения,
- $R_1, R_2$  — радиусы кривизны капли в двух направлениях.

Это уравнение связывает давление и форму капли. Для лежащей капли одно из давлений $\rho _2$ (в воздухе) считается постоянным, а 
$\rho _1$  зависит от высоты точки $z$ в капле.

---

### Шаг 2: Упрощение для задачи
Подставим 
$$
p_1 = p_0 - \rho g Z,
$$
где:

- $p_0$ - давление внутри капли на уровне $Z=0$,
- $\rho$ — плотность жидкости,  
- $g$ — ускорение свободного падения,  
- $Z$ — высота.


Давление внутри капли $p_1$ изменяется в зависимости от высоты, а $p_2$ (внешнее давление воздуха) — постоянное. Уравнение Лапласа связывает разность этих давлений с кривизной капли:

$$
p_1(Z) - p_2 = \sigma \left( \frac{1}{R_1} + \frac{1}{R_2} \right).
$$

Заменяя $p_1(Z) = p_0 - \rho g Z$, получаем:

$$
(p_0 - \rho g Z) - p_2 = \sigma \left( \frac{1}{R_1} + \frac{1}{R_2} \right).
$$

Часто $p_0$ и $p_2$ объединяются в одно избыточное давление $p_0 - p_2$, которое удобно использовать в расчетах. Это приводит к финальному виду:

$$
-\frac{Z}{\alpha^2} = \frac{1}{R_1} + \frac{1}{R_2},
$$

где $\alpha = \sqrt{\frac{\sigma}{\rho g}}$ — капиллярная постоянная.

---

### Шаг 3: Параметризация капли

Капля считается осесимметричной, поэтому её форма задаётся кривой, определённой в цилиндрических координатах $(r, Z)$. Вводим параметризацию через длину дуги $s$:
- Радиус $r(s)$,  
- Высота $Z(s)$,  
- Угол наклона $\varphi(s)$ между нормалью к кривой и осью $Z$.

Система уравнений для этих функций (получена из геометрии капли и упрощённого уравнения Лапласа):  
$$
\frac{d\varphi}{ds} = -\frac{\sin(\varphi)}{r} - \frac{Z}{\alpha^2},
$$
$$
\frac{dr}{ds} = \cos(\varphi),
$$
$$
\frac{dZ}{ds} = -\sin(\varphi).
$$

---

### Шаг 4: Задача Коши

Для решения этих уравнений задаются начальные условия (точка $s = 0$):
$$
r(0) = 0, \quad Z(0) = -z_0, \quad \varphi(0) = \varphi_0,
$$
где $z_0$ и $\varphi_0$ — параметры, определяющие начальную форму капли.

---

### Шаг 5: Решение системы

Форма капли (в терминах $r, Z, \varphi$) вычисляется численно. Метод Рунге-Кутты позволяет аппроксимировать решение с заданным шагом $h$, начиная с начальных условий.